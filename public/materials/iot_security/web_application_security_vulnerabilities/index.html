<!doctype html><html lang=zh-tw dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="zh-tw"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><title>3. IoT 網路應用系統安全弱點 &#183; Tonya's Blog</title>
<meta name=title content="3. IoT 網路應用系統安全弱點 &#183; Tonya's Blog"><link rel=canonical href=https://tonyatonya-nya.github.io/materials/iot_security/web_application_security_vulnerabilities/><link type=text/css rel=stylesheet href=/css/main.bundle.min.41ee9ef185955bfca2801fdbe92a2e7e2b7895441b106c79cbce453d8ee69c719727db5af87e7b8e5cf92fe618da09cb9e0fed577a881468dc4955c750ebf36c.css integrity="sha512-Qe6e8YWVW/yigB/b6Soufit4lUQbEGx5y85FPY7mnHGXJ9ta+H57jlz5L+YY2gnLng/tV3qIFGjcSVXHUOvzbA=="><script type=text/javascript src=/js/appearance.min.516a16745bea5a9bd011138d254cc0fd3973cd55ce6e15f3dec763e7c7c2c7448f8fe7b54cca811cb821b0c7e12cd161caace1dd794ac3d34d40937cbcc9ee12.js integrity="sha512-UWoWdFvqWpvQERONJUzA/TlzzVXObhXz3sdj58fCx0SPj+e1TMqBHLghsMfhLNFhyqzh3XlKw9NNQJN8vMnuEg=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.8613168837e35f3f882df60a8a810e212d581a4eea26eeb2554e527c6eab9e57acc03a2533cbd5c6084f825ce3a655953923f21e1de2e6b8014eddf510fa58e7.js integrity="sha512-hhMWiDfjXz+ILfYKioEOIS1YGk7qJu6yVU5SfG6rnleswDolM8vVxghPglzjplWVOSPyHh3i5rgBTt31EPpY5w==" data-copy data-copied></script><script src=/lib/zoom/zoom.min.fcbc7f7b3dcea96e3b5570cd322c5d7a12d5351c87f9889b1c31745a2cc711df58f6b70795a86d50e63813b236ade916668332c10a70a4ce26f7c0878f525fce.js integrity="sha512-/Lx/ez3OqW47VXDNMixdehLVNRyH+YibHDF0WizHEd9Y9rcHlahtUOY4E7I2rekWZoMywQpwpM4m98CHj1Jfzg=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://tonyatonya-nya.github.io/materials/iot_security/web_application_security_vulnerabilities/"><meta property="og:site_name" content="Tonya's Blog"><meta property="og:title" content="3. IoT 網路應用系統安全弱點"><meta property="og:locale" content="zh_tw"><meta property="og:type" content="article"><meta property="article:section" content="materials"><meta property="article:published_time" content="2024-09-08T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-08T00:00:00+00:00"><meta property="og:see_also" content="https://tonyatonya-nya.github.io/materials/iot_security/exercise/"><meta property="og:see_also" content="https://tonyatonya-nya.github.io/materials/iot_security/basic_knowledge/"><meta property="og:see_also" content="https://tonyatonya-nya.github.io/materials/iot_security/introduction/"><meta name=twitter:card content="summary"><meta name=twitter:title content="3. IoT 網路應用系統安全弱點"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"各種資安教材","name":"3. IoT 網路應用系統安全弱點","headline":"3. IoT 網路應用系統安全弱點","inLanguage":"zh-tw","url":"https:\/\/tonyatonya-nya.github.io\/materials\/iot_security\/web_application_security_vulnerabilities\/","author":{"@type":"Person","name":"Tonya"},"copyrightYear":"2024","dateCreated":"2024-09-08T00:00:00\u002b00:00","datePublished":"2024-09-08T00:00:00\u002b00:00","dateModified":"2024-09-08T00:00:00\u002b00:00","mainEntityOfPage":"true","wordCount":"6785"}]</script><meta name=author content="Tonya"><link href=mailto:quontonya@gmail.com rel=me><link href=https://github.com/TonyaTonya-Nya rel=me><link href=https://www.linkedin.com/in/tonyawu/ rel=me><script src=/lib/jquery/jquery.slim.min.03cb160e3cfdb2667a2e2c80d283bebcf63ff8bbc4b629c9ab2babf6fae1d0c07ad470edae783efa4fabda2ac01c58d60e63b98b3c336be8208460f08f4354f5.js integrity="sha512-A8sWDjz9smZ6LiyA0oO+vPY/+LvEtinJqyur9vrh0MB61HDtrng++k+r2irAHFjWDmO5izwza+gghGDwj0NU9Q=="></script><meta name=theme-color></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>快轉到主要內容</a></div><div style=padding-left:0;padding-right:0;padding-top:2px;padding-bottom:3px class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start space-x-3"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium text-gray-500 hover:text-gray-900">Tonya&rsquo;s Blog</a></nav><nav class="hidden md:flex items-center space-x-5 md:ml-12 h-12"><a href=/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Home</p></a><a href=/blogs/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Blogs</p></a><div><div class="cursor-pointer flex items-center nested-menu"><a href=/materials/ class="text-base font-medium text-gray-500 hover:text-primary-600 dark:hover:text-primary-400" title>Materials
</a><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></div><div class="absolute menuhide"><div class="pt-2 p-5 mt-2 rounded-xl backdrop-blur shadow-2xl"><div class="flex flex-col space-y-3"><a href=/materials/iot_security/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-sm" title>IoT Security</p></a></div></div></div></div><a href=/prose/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Prose</p></a><a href=/friends/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-base font-medium" title>Friend Links</p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="ltr:mr-14 rtl:ml-14 flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center space-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title>
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400" style=margin-right:5px><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 -mr-2 md:hidden"><label id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper style=padding-top:5px class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Home</p></a></li><li class=mt-1><a href=/blogs/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Blogs</p></a></li><li class=mt-1><a class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Materials</p><span><span class="relative block icon"><svg viewBox="0 0 20 20" fill="currentcolor" aria-hidden="true"><path fill-rule="evenodd" d="M5.23 7.21a.75.75.0 011.06.02L10 11.168l3.71-3.938a.75.75.0 111.08 1.04l-4.25 4.5a.75.75.0 01-1.08.0l-4.25-4.5a.75.75.0 01.02-1.06z" clip-rule="evenodd"/></svg></span></span></a></li><li class=mt-1><a href=/materials/iot_security/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-sm font-small" title>IoT Security</p></a></li><li class=mb-2></li><li class=mt-1><a href=/prose/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Prose</p></a></li><li class=mt-1><a href=/friends/ class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400"><p class="text-bg font-bg" title>Friend Links</p></a></li></ul></div></label></div></div><div class="relative flex flex-col grow"><main id=main-content class=grow><article><div class="w-full h-36 md:h-56 lg:h-72 single_hero_basic nozoom" style=background-image:url(/img/background_hu5586356105617036979.png)></div><div id=progbar></div><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">3. IoT 網路應用系統安全弱點</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2024-09-08T00:00:00+00:00>8 September 2024</time><span class="px-2 text-primary-500">&#183;</span><span>6785 字</span><span class="px-2 text-primary-500">&#183;</span><span title=預計閱讀時間>14 分鐘</span></div><div class="flex flex-row flex-wrap items-center"><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/iot_security/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">IoT_Security
</span></span></span><span style=margin-top:.5rem class=mr-2 onclick='window.open("/categories/materials/","_self")'><span class=flex style=cursor:pointer><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Materials</span></span></span></div></div></header><script src=/js/progbar.js></script><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10"><details open id=TOCView class="toc-right mt-0 overflow-y-scroll overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">目錄</summary><div class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#owasp-top-10-簡介>🦉OWASP Top 10 簡介</a></li><li><a href=#a01-權限控制失效>🦉A01 權限控制失效</a></li><li><a href=#a02-加密機制失效>🦉A02 加密機制失效</a></li><li><a href=#a03-注入式攻擊>🦉A03 注入式攻擊</a></li><li><a href=#a04-不安全設計>🦉A04 不安全設計</a></li><li><a href=#a05-安全設定缺陷>🦉A05 安全設定缺陷</a></li><li><a href=#a06-危險或過舊的元件>🦉A06 危險或過舊的元件</a></li><li><a href=#a07-認證及驗證機制失效>🦉A07 認證及驗證機制失效</a></li><li><a href=#a08-軟體及資料完整性失效>🦉A08 軟體及資料完整性失效</a></li><li><a href=#a09-資安記錄及監控失效>🦉A09 資安記錄及監控失效</a></li><li><a href=#a10-伺服端請求偽造>🦉A10 伺服端請求偽造</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">目錄</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#owasp-top-10-簡介>🦉OWASP Top 10 簡介</a></li><li><a href=#a01-權限控制失效>🦉A01 權限控制失效</a></li><li><a href=#a02-加密機制失效>🦉A02 加密機制失效</a></li><li><a href=#a03-注入式攻擊>🦉A03 注入式攻擊</a></li><li><a href=#a04-不安全設計>🦉A04 不安全設計</a></li><li><a href=#a05-安全設定缺陷>🦉A05 安全設定缺陷</a></li><li><a href=#a06-危險或過舊的元件>🦉A06 危險或過舊的元件</a></li><li><a href=#a07-認證及驗證機制失效>🦉A07 認證及驗證機制失效</a></li><li><a href=#a08-軟體及資料完整性失效>🦉A08 軟體及資料完整性失效</a></li><li><a href=#a09-資安記錄及監控失效>🦉A09 資安記錄及監控失效</a></li><li><a href=#a10-伺服端請求偽造>🦉A10 伺服端請求偽造</a></li></ul></nav></div></details><script>var margin=200,marginError=50;(function(){var t=$(window),e=$("#TOCView"),s=e.height();function n(){var n=t.height()-margin;s>=n?(e.css("overflow-y","scroll"),e.css("max-height",n+marginError+"px")):(e.css("overflow-y","hidden"),e.css("max-height","9999999px"))}t.on("resize",n),$(document).ready(n)})()</script></div></div><div class="min-w-0 min-h-0 max-w-fit"><details style=margin-left:0 class="mt-2 mb-5 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5"><summary class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-primary-800 dark:text-neutral-100">IoT 設備檢測實務：攻擊實戰與防禦指南 - 本文屬於一個選集。</summary><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=https://tonyatonya-nya.github.io/materials/iot_security/introduction/>§ 1: 1. IoT 設備安全簡介</a></div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=https://tonyatonya-nya.github.io/materials/iot_security/basic_knowledge/>§ 2: 2. IoT 設備安全基礎知識</a></div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">§ 3: 本文</div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=https://tonyatonya-nya.github.io/materials/iot_security/exercise/>§ 4: 4. IoT 設備檢測實戰演練</a></div></details><div class="article-content max-w-prose mb-20"><h2 class="relative group">🦉OWASP Top 10 簡介<div id=owasp-top-10-%E7%B0%A1%E4%BB%8B class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#owasp-top-10-%E7%B0%A1%E4%BB%8B aria-label=定位點>#</a></span></h2><p>OWASP (Open Web Application Security Project) 是一個開放的社群非營利組織，致力於研究網際網路應用程式安全的標準、工具和技術，協助政府和企業理解並改善應用程式的安全性。</p><p>OWASP 最著名的是一份針對網路應用程式安全性的排名 - OWASP Top 10。它列出了目前最常見的十個網路應用程式安全風險，提供給開發人員、測試人員和資安人員作為指南以確保應用程式的安全防護。OWASP Top 10 大約每三年更新一次，以確保此份情資能夠跟上時代腳步。本課程將使用 OWASP Top 10 2021 來幫助學員了解弱點產生以及弱點防禦。</p><p>在 OWASP 中有許多領域的安全威脅排名，而最著名的排名是 OWASP Top 10。此排名中包含了各種由於管理疏忽或者是開發錯誤從而產生的弱點。OWASP IoT Top 10 則是在描述 IoT 設備常見的安全弱點。OWASP 也有針對 API、行動裝置、AI 等領域列出前十大資安威脅弱點。</p><p>以下是目前的 OWASP Top 10：</p><table><thead><tr><th style=text-align:left>名稱</th><th style=text-align:left>領域</th></tr></thead><tbody><tr><td style=text-align:left>OWASP Top 10</td><td style=text-align:left>管理 / 開發</td></tr><tr><td style=text-align:left>OWASP IoT Top 10</td><td style=text-align:left>IoT 設備</td></tr><tr><td style=text-align:left>OWASP API Top 10</td><td style=text-align:left>API</td></tr><tr><td style=text-align:left>OWASP Mobile Top 10</td><td style=text-align:left>手機 / 行動裝置</td></tr><tr><td style=text-align:left>OWASP Machine Learning Top 10</td><td style=text-align:left>AI</td></tr></tbody></table><h2 class="relative group">🦉A01 權限控制失效<div id=a01-%E6%AC%8A%E9%99%90%E6%8E%A7%E5%88%B6%E5%A4%B1%E6%95%88 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#a01-%E6%AC%8A%E9%99%90%E6%8E%A7%E5%88%B6%E5%A4%B1%E6%95%88 aria-label=定位點>#</a></span></h2><p>權限控制失效 (Broken Access Control) 弱點發生的原因是由於使用者能夠訪問到本不應該訪問到的頁面或是功能，從而導致資訊洩漏或是越權控制的風險。此弱點發生的情況通常是當使用者訪問了一個需要身份驗證才能存取的頁面時，開發者沒有加入對使用者進行身份驗證的程式碼，從而導致使用者不需要經過身份驗證也能對其進行訪問與控制。</p><p>發生該弱點的程式碼通常具有以下幾點特徵：</p><ul><li>沒有對 HTTP Request 進行身份驗證</li><li>沒有對敏感目錄進行權限控管</li><li>沒有對使用者的 session 進行驗證</li></ul><p>請參考以下範例，以下為沒有完整驗證使用者身份的 php 程式碼：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// verify.php
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nx>session_start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$secret_text</span> <span class=o>=</span> <span class=s2>&#34;secret_text&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$_SERVER</span><span class=p>[</span><span class=s2>&#34;REQUEST_METHOD&#34;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&#34;POST&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$user_input</span> <span class=o>=</span> <span class=nv>$_POST</span><span class=p>[</span><span class=s2>&#34;secret&#34;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$user_input</span> <span class=o>===</span> <span class=nv>$secret_text</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$_SESSION</span><span class=p>[</span><span class=s2>&#34;authenticated&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>header</span><span class=p>(</span><span class=s2>&#34;Location: admin.php&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>exit</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>echo</span> <span class=s2>&#34;Your input does not match the secret text.&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// admin.php
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=s1>&#39;Welcome, administrator!&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><p>觀察 <code>if()</code> 部分的程式碼，跳轉至 <code>admin.php</code> 頁面的條件式為 <code>$user_input === $secret_text</code>，乍看之下進入該頁面的條件唯有 admin 能夠達成，但如果我們沒有在 <code>admin.php</code> 頁面驗證使用者的 session 是否有效，攻擊者能夠透過直接訪問 <code>admin.php</code> 從而導致權限控制失效的問題。</p><p>請參考以下範例，以下是修補過後有驗證使用者身份的 php 程式碼：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>// admin.php
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nx>session_start</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;is_admin&#39;</span><span class=p>])</span> <span class=o>||</span> <span class=nv>$_SESSION</span><span class=p>[</span><span class=s1>&#39;is_admin&#39;</span><span class=p>]</span> <span class=o>===</span> <span class=k>false</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>header</span><span class=p>(</span><span class=s2>&#34;Location: login.php&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>exit</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 如果通過了上面的檢查，那麼使用者就可以訪問這個頁面的內容
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>echo</span> <span class=s1>&#39;Welcome, administrator!&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><p>在剛剛範例中的 <code>admin.php</code> 沒有對使用者進行身份驗證從而導致權限控制失效的問題。為了解決這個問題，可以在 <code>admin.php</code> 中加入對使用者進行身份驗證的程式碼，讓沒有經過身份驗證的使用者或是並非 admin 的使用者重新導向回登入頁面。</p><p>請參考以下範例，以下是一個不安全的 nginx 設定範例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>listen</span> <span class=mi>80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>server_name</span> <span class=s>example.com</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>location</span> <span class=s>/admin/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>root</span> <span class=s>/var/www/html/admin/</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>index</span> <span class=s>index.html</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>root</span> <span class=s>/var/www/html/</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>index</span> <span class=s>index.html</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>觀察 <code>/admin/</code> 部分的設定，可以發現該目錄並沒有進行權限控管，導致任意使用者都能訪問在 <code>/admin/</code> 路徑下的 <code>index.html</code> 以及其他檔案，可能導致敏感資訊的洩漏或未經授權的系統操作，造成權限控制失效的問題。</p><p>請參考以下範例，以下是修補過後經過存取控制的 nginx 設定範例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=line><span class=cl><span class=k>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>listen</span> <span class=mi>80</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kn>server_name</span> <span class=s>example.com</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>location</span> <span class=s>/admin/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>root</span> <span class=s>/var/www/html/admin/</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>index</span> <span class=s>index.html</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1># 基於 IP 位置的存取限制
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kn>allow</span> <span class=mi>192</span><span class=s>.168.0.0/24</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>deny</span> <span class=s>all</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>root</span> <span class=s>/var/www/html/</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>index</span> <span class=s>index.html</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>觀察 <code>/admin/</code> 部分的設定，可以發現我們新增了兩行設定，限制 <code>/admin/</code> 路徑僅能從 <code>192.168.0.0/24</code> 網段才可被訪問。當然，也能使用身份驗證機制來確保只有授權的使用者可以訪問 <code>/admin/</code>。</p><p>以上兩個範例展示了權限控制失效問題產生的原因與防禦方式，要防禦此弱點，我們可以檢查是否已經針對以下項目做好防禦。</p><ul><li>在每個 Request 中都對使用者進行身份驗證</li><li>對敏感目錄進行權限控管</li><li>對使用者的 session 進行限制</li></ul><h2 class="relative group">🦉A02 加密機制失效<div id=a02-%E5%8A%A0%E5%AF%86%E6%A9%9F%E5%88%B6%E5%A4%B1%E6%95%88 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#a02-%E5%8A%A0%E5%AF%86%E6%A9%9F%E5%88%B6%E5%A4%B1%E6%95%88 aria-label=定位點>#</a></span></h2><p>加密機制失效 (Cryptographic Failures) 弱點發生的原因主要是由於開發者使用不適當的方式保護使用者的敏感資訊，從而導致攻擊者能竊取到敏感資訊。例如：登入憑證、身分證字號、信用卡號等。</p><p>發生該弱點的程式碼通常會具有以下幾點特徵：</p><ul><li>敏感資訊以明碼傳輸，例如：HTTP、SMTP、FTP 等協定</li><li>使用老舊或已知存在安全風險的加密演算法，例如：DES</li><li>使用預設的 Encrypt Key 或是弱密碼</li><li>沒有將敏感資訊加密儲存</li></ul><p>請參考以下範例，以下是一個使用 HTTP 傳輸的封包被攔截的範例，受害者使用了 HTTP 協定來傳輸敏感資料，使得攻擊者能夠完整的讀取受害者傳輸的封包內容。<figure><img class="my-0 rounded-md" loading=lazy srcset="/materials/iot_security/web_application_security_vulnerabilities/http_hu9848556338174407202.png 330w,
/materials/iot_security/web_application_security_vulnerabilities/http_hu4433850098673721298.png 660w,
/materials/iot_security/web_application_security_vulnerabilities/http_hu1068310566840732017.png 1024w,
/materials/iot_security/web_application_security_vulnerabilities/http_hu5514340721382486288.png 2x" src=/materials/iot_security/web_application_security_vulnerabilities/http_hu4433850098673721298.png alt=http></figure></p><p>請參考以下範例，以下是一個使用 HTTPS 傳輸的封包被攔截的範例，相對於 HTTP 協定，可以發現受害者的封包經過加密後，攻擊者無法得知傳輸的封包內容。<figure><img class="my-0 rounded-md" loading=lazy srcset="/materials/iot_security/web_application_security_vulnerabilities/https_hu15079559563392776257.png 330w,
/materials/iot_security/web_application_security_vulnerabilities/https_hu7117193568692231086.png 660w,
/materials/iot_security/web_application_security_vulnerabilities/https_hu9871388318152877043.png 1024w,
/materials/iot_security/web_application_security_vulnerabilities/https_hu7077068657331122751.png 2x" src=/materials/iot_security/web_application_security_vulnerabilities/https_hu7117193568692231086.png alt=https></figure></p><p>請參考以下範例，以下是一個儲存使用者資料的 SQL table ，但儲存時沒有將密碼使用 Hash 儲存而是使用明文儲存。若攻擊者成功進入系統或是訪問資料庫將造成帳號資料外洩的風險，攻擊者將能輕易獲取明文密碼。</p><table><thead><tr><th style=text-align:left>id</th><th style=text-align:left>user</th><th style=text-align:left>pass</th></tr></thead><tbody><tr><td style=text-align:left>1</td><td style=text-align:left>admin</td><td style=text-align:left>password</td></tr><tr><td style=text-align:left>2</td><td style=text-align:left>user1</td><td style=text-align:left>meow1234</td></tr><tr><td style=text-align:left>3</td><td style=text-align:left>user2</td><td style=text-align:left>qqmeowmeow</td></tr></tbody></table><p>以上兩個範例展示了加密機制失效問題產生的原因與防禦方式，要防禦此弱點，我們可以檢查是否已經針對以下項目做好防禦。</p><ul><li>除非必要，否則不向使用者索取敏感資訊</li><li>使用安全的加密演算法來加密儲存資訊</li><li>使用 Hash 來保護使用者的密碼</li><li>使用加密協定，例如：HTTPS</li></ul><h2 class="relative group">🦉A03 注入式攻擊<div id=a03-%E6%B3%A8%E5%85%A5%E5%BC%8F%E6%94%BB%E6%93%8A class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#a03-%E6%B3%A8%E5%85%A5%E5%BC%8F%E6%94%BB%E6%93%8A aria-label=定位點>#</a></span></h2><p>注入式攻擊 (Injection) 是一種常見的漏洞，允許攻擊者將惡意輸入注入到程式碼或指令中，使其成為程式碼或指令的一部分。這種攻擊通常是因為在接收輸入資料時未對輸入進行適當的驗證和過濾而導致。</p><p>常見的注入攻擊有以下幾種：</p><ul><li>指令注入攻擊 (Command Injection，Cmdi)：<ul><li>攻擊者利用漏洞將惡意指令注入到指令拼接間，使其在目標系統上執行預期外的指令。可能導致攻擊者透過遠端程式碼執行取得 Shell。</li></ul></li><li>SQL 語句注入攻擊 (SQL Injection，SQLi)：<ul><li>攻擊者將惡意 SQL 語句注入到應用程式的原始 SQL 語句中以控制查詢語句。可能導致資料庫洩漏、任意讀取檔案、透過遠端程式碼執行取得 Shell。</li></ul></li><li>跨網站指令碼注入攻擊 (Cross-Site Scripting，XSS)：<ul><li>攻擊者在網頁中注入惡意 JavaScript 腳本，控制瀏覽器執行危險程式碼。可能導致資訊洩漏、偽造用戶、透過遠端程式碼執行取得 Shell。</li></ul></li><li>伺服器模板注入攻擊 (Server-Side Template Injection ，SSTi)：<ul><li>攻擊者將惡意的模板引擎程式碼注入到模板內，控制伺服器端模板引擎。可能導致任意讀取檔案、透過遠端程式碼執行取得 Shell。</li></ul></li></ul><p>請參考以下範例，以下是一個 Command Injection 的 PHP 程式碼範例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span> <span class=nx>system</span><span class=p>(</span><span class=s2>&#34;ping  -c 4 &#34;</span> <span class=o>+</span> <span class=nv>$IP</span><span class=p>);</span><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><p>假設使用者的輸入不經過任何驗證完整地傳入變數 <code>$IP</code>。在正常情況下，輸入如果為 <code>127.0.0.1</code>，程式會將使用者的輸入完整放入指令中，如下所示：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ping -c <span class=m>4</span> 127.0.0.1
</span></span></code></pre></div><p>如果該指令正常運作，將會產生以下輸出：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PING 127.0.0.1 <span class=o>(</span>127.0.0.1<span class=o>)</span> 56<span class=o>(</span>84<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 127.0.0.1： <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.053 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 127.0.0.1： <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.037 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 127.0.0.1： <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.036 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 127.0.0.1： <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>4</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.031 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 127.0.0.1 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>4</span> packets transmitted, <span class=m>4</span> received, 0% packet loss, <span class=nb>time</span> 3061ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 0.029/0.033/0.038/0.003 ms
</span></span></code></pre></div><p>在 Linux 中，分號 <code>;</code> 代表結束當前指令，並且執行後續指令。因此，如果在輸入中加入分號，將使得單行輸入可以執行兩個及以上的指令。如果攻擊者輸入 <code>127.0.0.1 ; id</code>，此時指令將變成：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ping -c <span class=m>4</span> 127.0.0.1 <span class=p>;</span> id
</span></span></code></pre></div><p>如果該指令正常運作，將會產生以下輸出：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PING 127.0.0.1 <span class=o>(</span>127.0.0.1<span class=o>)</span> 56<span class=o>(</span>84<span class=o>)</span> bytes of data.
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 127.0.0.1： <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>1</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.029 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 127.0.0.1： <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>2</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.032 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 127.0.0.1： <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>3</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.034 ms
</span></span><span class=line><span class=cl><span class=m>64</span> bytes from 127.0.0.1： <span class=nv>icmp_seq</span><span class=o>=</span><span class=m>4</span> <span class=nv>ttl</span><span class=o>=</span><span class=m>64</span> <span class=nv>time</span><span class=o>=</span>0.038 ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--- 127.0.0.1 ping statistics ---
</span></span><span class=line><span class=cl><span class=m>4</span> packets transmitted, <span class=m>4</span> received, 0% packet loss, <span class=nb>time</span> 3069ms
</span></span><span class=line><span class=cl>rtt min/avg/max/mdev <span class=o>=</span> 0.029/0.033/0.038/0.003 ms
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>33<span class=o>(</span>www-data<span class=o>)</span>
</span></span></code></pre></div><p>在輸出的最後一行，可以看到 <code>id</code> 指令被成功執行。同時也代表攻擊者可以在此處執行任意命令，達到遠端執行任意程式碼 (Remote Code Execution，RCE) 的目的。</p><p>由於 Injection 攻擊通常能讓攻擊者取得 RCE，因此此類攻擊通常會是攻擊者優先瞄準的目標。要防禦此弱點，我們可以檢查是否已經針對以下項目做好防禦。</p><ul><li>過濾使用者輸入的特殊符號</li><li>將實際運作的指令與使用者的輸入分離</li><li>對使用者的輸入進行二次驗證</li></ul><h2 class="relative group">🦉A04 不安全設計<div id=a04-%E4%B8%8D%E5%AE%89%E5%85%A8%E8%A8%AD%E8%A8%88 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#a04-%E4%B8%8D%E5%AE%89%E5%85%A8%E8%A8%AD%E8%A8%88 aria-label=定位點>#</a></span></h2><p>不安全設計 (Insecure Design) 是一種定義廣泛的概述，涵蓋了在設計階段未能充分考慮並解決的安全問題。這類問題可能源於多種原因，例如：未妥善處理使用者的輸入輸出、未正確實施安全措施、無效的身份驗證等。儘管不安全設計的概念有點抽象，但我們可以藉由觀察幾個範例來了解不安全的設計包含的情況。</p><ol><li>密碼重置問題：
在使用者忘記密碼時，有些網站會藉由讓使用者回答【你所就讀的小學】或【你父母的名字】這類問題來重置密碼。這種情況下，攻擊者可能可以透過在社交媒體、網路搜索等公開資源來獲得答案，使得這種恢復密碼的方式具有風險。在社群媒體上常常會有人將自己的資料公開，我們可以利用此特點來嘗試找到這些題目的解答，或者是使用社交工程來嘗試套出目標的資訊等。</li></ol><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/materials/iot_security/web_application_security_vulnerabilities/OSINT_hu16377919895937041196.png 330w,
/materials/iot_security/web_application_security_vulnerabilities/OSINT_hu4621055692445075625.png 660w,
/materials/iot_security/web_application_security_vulnerabilities/OSINT_hu1476272673102884733.png 1024w,
/materials/iot_security/web_application_security_vulnerabilities/OSINT_hu11565985435011156799.png 2x" src=/materials/iot_security/web_application_security_vulnerabilities/OSINT_hu4621055692445075625.png alt=OSINT></figure></p><ol start=2><li>爆破攻擊與洪水式攻擊：
若未設置有效防止機器人的保護機制，可能會導致惡意攻擊者用自動化工具對網站進行攻擊。攻擊者可以透過不斷嘗試不同的用戶名和密碼組合，直到找到正確的組合或猜中密碼，稱為爆破攻擊 (Brute Force Attack)。攻擊者也能透過向目標系統發送大量的流量或請求，以超出其處理能力限制，使得真正的使用者無法正常使用系統，稱為洪水式攻擊 (Flood Attack)。</li></ol><p>請參考以下範例，以下範例是一個洪水式攻擊的例子，攻擊者透過發送大量的 HTTP Requests 來連接至目標，並嘗試消耗其處理能量來導致伺服器癱瘓的問題。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/materials/iot_security/web_application_security_vulnerabilities/dos_hu17578116391443113259.png 330w,
/materials/iot_security/web_application_security_vulnerabilities/dos_hu16873785106526361511.png 660w,
/materials/iot_security/web_application_security_vulnerabilities/dos_hu9867592921318183041.png 1024w,
/materials/iot_security/web_application_security_vulnerabilities/dos_hu17559773173278514697.png 2x" src=/materials/iot_security/web_application_security_vulnerabilities/dos_hu16873785106526361511.png alt=dos></figure></p><p>請參考以下範例，以下範例是暴力破解的例子，當網站沒有限制 IP 對其登入或者任意路徑進行大量請求時，攻擊者可以利用此點來進行掃描路徑、暴力破解等攻擊行為。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/materials/iot_security/web_application_security_vulnerabilities/brute_hu2366702069864841867.png 330w,
/materials/iot_security/web_application_security_vulnerabilities/brute_hu7277791558827595395.png 660w,
/materials/iot_security/web_application_security_vulnerabilities/brute_hu9612987948890122297.png 1024w,
/materials/iot_security/web_application_security_vulnerabilities/brute_hu12567788682217175284.png 2x" src=/materials/iot_security/web_application_security_vulnerabilities/brute_hu7277791558827595395.png alt=brute></figure></p><p>為了防禦不安全設計的弱點，我們需要在設計階段就將安全因素納入考量，並將其視為設計目標的重要部分。在開發過程中我們可以採用安全軟體開發生命週期 (Secure Software Development Life Cycle，SSDLC) 的模型，嚴格遵守相關原則，以大幅降低弱點出現的可能性。回顧剛剛提到會發生弱點的地方，我們能夠從開發階段提出幾個解決辦法。</p><ol><li>密碼重置問題：<ul><li>由於用於密碼重置的問題答案通常不只有使用者一個人知道，攻擊者能利用公開來源情報 (Open Source INTelligence，OSINT) 來獲得答案，因此此類設計應該被移除或是使用更安全的設計，例如：雙重認證 (Two-factor authentication，2FA) 等機制來替代。</li></ul></li><li>爆破攻擊與洪水式攻擊：<ul><li>由於爆破攻擊與洪水式攻擊會產生大量異常的流量，因此我們可以透過流量過濾的方式來檢測和過濾異常的流量。此外，也能使用人機驗證 (Captcha) 來檢測使用者是否為自動化腳本。</li></ul></li></ol><h2 class="relative group">🦉A05 安全設定缺陷<div id=a05-%E5%AE%89%E5%85%A8%E8%A8%AD%E5%AE%9A%E7%BC%BA%E9%99%B7 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#a05-%E5%AE%89%E5%85%A8%E8%A8%AD%E5%AE%9A%E7%BC%BA%E9%99%B7 aria-label=定位點>#</a></span></h2><p>安全設定缺陷 (Security Misconfiguration) 弱點產生的原因主要是因為正在運行的系統、軟體，由於安全設定的不正確，從而導致暴露了過多的資訊以及攻擊面。舉例來說，如果我們對於一個 IoT 設備服務只需要提供網頁介面，那麼對於使用者端要開放的也僅有網頁的服務，而不應該額外開放如：SSH、FTP 等服務。</p><p>該弱點通常具有以下幾點特徵：</p><ul><li>啟用不必要的功能</li><li>使用預設的密碼或是登入憑證</li><li>程式執行未正確判斷例外，導致錯誤訊息透漏服務背後的技術與版本</li><li>系統設定導致可能存在安全風險的功能被開啟</li></ul><p>請參考以下範例，以下是一個開啟不必要服務的範例，在這台設備上可以看出目標的定位應是提供使用者網頁服務，但卻開啟了 MySQL 的 3306 埠，MySQL 是一個並不需要對外的服務，會讓設備增加可能會被駭客入侵的攻擊面。若想維持系統正常運作並同時減少攻擊面，可以將 8080 埠改為 80 埠並設定連線規則只允許 80 埠對外。若有遠端管理需求，可以將 SSH 對外同時設定 <code>/etc/ssh/sshd_config</code> 只允許從內網進行連線，便能在服務穩定運作的同時減少攻擊面。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/materials/iot_security/web_application_security_vulnerabilities/nmap_hu2188383763482021537.png 330w,
/materials/iot_security/web_application_security_vulnerabilities/nmap_hu11884243617149449507.png 660w,
/materials/iot_security/web_application_security_vulnerabilities/nmap_hu13016448028939789588.png 1024w,
/materials/iot_security/web_application_security_vulnerabilities/nmap_hu6113388818609617019.png 2x" src=/materials/iot_security/web_application_security_vulnerabilities/nmap_hu11884243617149449507.png alt=nmap></figure></p><p>要防禦此弱點，我們可以檢查是否已經針對以下項目做好防禦。</p><ul><li>關閉非必要的埠、服務、網頁頁面和帳號特權等</li><li>修改預設密碼，並遵循密碼複雜度原則</li><li>關閉錯誤訊息以防止針對性的攻擊</li></ul><h2 class="relative group">🦉A06 危險或過舊的元件<div id=a06-%E5%8D%B1%E9%9A%AA%E6%88%96%E9%81%8E%E8%88%8A%E7%9A%84%E5%85%83%E4%BB%B6 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#a06-%E5%8D%B1%E9%9A%AA%E6%88%96%E9%81%8E%E8%88%8A%E7%9A%84%E5%85%83%E4%BB%B6 aria-label=定位點>#</a></span></h2><p>使用危險或過舊的元件 (Vulnerable and Outdated Components) 弱點產生的原因是由於開發時使用了具有漏洞的元件進行開發。攻擊者往往會尋找並利用已知的漏洞來對這些老舊的服務進行攻擊。這樣的攻擊手法範疇廣泛，可以針對的目標從作業系統、網頁伺服器、到具體的軟體套件或插件。</p><p>許多過時或有已知漏洞的軟體和服務常用於 IoT 設備上，例如：<code>vsftpd 2.3.4</code> 存在不須經過身分驗證的 RCE 漏洞。同樣地，<code>Dropbear SSH 0.34</code> 也存在 RCE 漏洞。下圖是 <code>vsftpd 2.3.4</code> 的 CVE 編號，其 CVSS 分數高達 10.0 分。</p><p><figure><img class="my-0 rounded-md" loading=lazy srcset="/materials/iot_security/web_application_security_vulnerabilities/cvss_hu5302668285075576605.png 330w,
/materials/iot_security/web_application_security_vulnerabilities/cvss_hu1971892359042721686.png 660w,
/materials/iot_security/web_application_security_vulnerabilities/cvss_hu7447857182750332781.png 1024w,
/materials/iot_security/web_application_security_vulnerabilities/cvss_hu5036081421542526030.png 2x" src=/materials/iot_security/web_application_security_vulnerabilities/cvss_hu1971892359042721686.png alt=cvss></figure></p><p>要防禦此弱點，我們可以檢查是否已經針對以下項目做好防禦。</p><ul><li>以自動化的方式檢查系統是否存在已知的安全漏洞</li><li>更新以確保系統元件或服務保持在最新的版本</li><li>更新套件時，從軟體開發者的官方網站下載</li></ul><h2 class="relative group">🦉A07 認證及驗證機制失效<div id=a07-%E8%AA%8D%E8%AD%89%E5%8F%8A%E9%A9%97%E8%AD%89%E6%A9%9F%E5%88%B6%E5%A4%B1%E6%95%88 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#a07-%E8%AA%8D%E8%AD%89%E5%8F%8A%E9%A9%97%E8%AD%89%E6%A9%9F%E5%88%B6%E5%A4%B1%E6%95%88 aria-label=定位點>#</a></span></h2><p>認證及驗證機制失效 (Identification and Authentication Failures) 弱點產生的原因是沒有正確對驗證機制所需的資訊做處理。它可能讓未經授權的人獲得進入系統的權限，並取得敏感資訊。該弱點出現的主要原因主要是由於程式或是網站在驗證使用者時存在缺陷，從而導致攻擊者能夠偽裝其他使用者來取得其他使用者的控制權限。</p><p>該弱點通常具有以下幾點特徵：</p><ul><li>沒有針對暴力破解或其他自動化攻擊的防護措施</li><li>使用預設密碼</li><li>允許使用者使用弱密碼</li><li>沒有正確的刪除 session</li></ul><p>請參考以下範例，登入頁面設定了使用者的 session，但是在登出時，使用者的 session 並沒有被刪除，若攻擊者在使用者登出後取得使用者曾經使用過的 session，那麼該 session 依然有效的情況下就能訪問到該使用者所擁有的權限。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nx>session_start</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>session_unset</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>header</span><span class=p>(</span><span class=s1>&#39;Location: login.php&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>exit</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><p>請參考以下範例，僅需記得將 session 正確銷毀，避免攻擊者使用了使用者之前使用過的 session 訪問需經過身分驗證的頁面。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nx>session_start</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>session_unset</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>session_destroy</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>header</span><span class=p>(</span><span class=s1>&#39;Location: login.php&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>exit</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><p>要防禦此弱點，我們可以檢查是否已經針對以下項目做好防禦。</p><ul><li>使用隨機生成密碼作為初始密碼</li><li>增加登入限制，如登入次數、IP 等</li><li>在登出後刪除使用者的 session</li><li>使用最小特權原則開發</li></ul><p>最小特權原則 (PoLP) 是開發上一個非常重要的觀念，意味著每個使用者或系統應該只有完成其任務所必需的權限。遵循該原則開發的系統，可以降低認證或驗證機制失敗的風險，減少攻擊者可能取得的權限。</p><h2 class="relative group">🦉A08 軟體及資料完整性失效<div id=a08-%E8%BB%9F%E9%AB%94%E5%8F%8A%E8%B3%87%E6%96%99%E5%AE%8C%E6%95%B4%E6%80%A7%E5%A4%B1%E6%95%88 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#a08-%E8%BB%9F%E9%AB%94%E5%8F%8A%E8%B3%87%E6%96%99%E5%AE%8C%E6%95%B4%E6%80%A7%E5%A4%B1%E6%95%88 aria-label=定位點>#</a></span></h2><p>軟體及資料完整性失效 (Software and Data Integrity Failures) 產生的原因是軟體被未經授權的第三方改動造成軟體及資料完整性受到損害，從而導致軟體本身自帶後門或是惡意程式碼等問題。此弱點的判定方式主要可以根據資安核心三要素 (CIA) 的完整性 (Integrity) 來判斷是否產生。</p><p>CIA 是機密性 (Confidentiality)、完整性 (Integrity)、可用性 (Availability) 的首字母縮寫，是評估資安策略的三個基本要素。完整性，指的是保護資訊和系統免受未經授權或不正確的修改。對於資訊，完整性確保了資訊的正確性以及來源可信。對於系統，完整性確保了系統如預期運行，並且沒有被未經授權的攻擊者惡意修改。</p><p>要防禦此弱點，我們可以檢查是否已經針對以下項目做好防禦。</p><ul><li>使用數位簽章或 Hash 檢查套件或軟體的完整性</li></ul><h2 class="relative group">🦉A09 資安記錄及監控失效<div id=a09-%E8%B3%87%E5%AE%89%E8%A8%98%E9%8C%84%E5%8F%8A%E7%9B%A3%E6%8E%A7%E5%A4%B1%E6%95%88 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#a09-%E8%B3%87%E5%AE%89%E8%A8%98%E9%8C%84%E5%8F%8A%E7%9B%A3%E6%8E%A7%E5%A4%B1%E6%95%88 aria-label=定位點>#</a></span></h2><p>資安記錄及監控失效 (Security Logging and Monitoring Failures) 弱點發生的原因是由於資安監控失效所引起的。資安監控有助於及時發現和應對安全威脅。從勒索病毒到釣魚攻擊，從 DDoS 到資訊洩漏，都對 IoT 設備的整體安全構成威脅。因此，有效的資訊安全監控策略是防範這些威脅的重要工具。</p><p>入侵檢測系統和入侵防護系統是資訊安全監控中的重要元素，入侵檢測系統 (Intrusion Detection System，IDS) 是一種實體設備或是軟體，用於監控網路或系統的活動以檢測可能的惡意行為。IDS 可以基於網路 (NIDS)，也可以基於主機 (HIDS)。當 IDS 檢測到可疑活動時，便會生成資安事件告警並通知 SOC 人員。入侵防護系統 (Intrusion Prevention System, IPS) 不僅可以檢測到攻擊者的入侵行為，還能阻止其發生。IPS 可以識別對系統發出的潛在的惡意流量，並攔截並阻止。</p><p>以下是兩個資安記錄及監控失效從而導致資安事件產生的現實案例。</p><ol><li>某間醫院由於缺乏監控和紀錄因此無法偵測入侵威脅，導致攻擊者入侵時無法正確的監控和防禦事件發生，並且在恢復階段時由於沒有日誌參考，因此也無法得知系統的弱點。</li><li>某間購物商場由於缺乏監控和紀錄設備，因此攻擊者在入侵後潛伏了數年之久，並且於發現入侵後因缺乏日誌參考，因此也無法追蹤攻擊者。</li></ol><p>要防禦此弱點，我們可以檢查是否已經針對以下項目做好防禦：</p><ul><li>確保日誌記錄重要事件</li><li>確保日誌格式符合能輕易讀懂、且格式化的形式</li><li>確保日誌不會受到污染攻擊</li><li>安裝 IDS / IPS 等安全防護系統已保證資安監控完善</li></ul><h2 class="relative group">🦉A10 伺服端請求偽造<div id=a10-%E4%BC%BA%E6%9C%8D%E7%AB%AF%E8%AB%8B%E6%B1%82%E5%81%BD%E9%80%A0 class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#a10-%E4%BC%BA%E6%9C%8D%E7%AB%AF%E8%AB%8B%E6%B1%82%E5%81%BD%E9%80%A0 aria-label=定位點>#</a></span></h2><p>伺服器端請求偽造 (Server Side Request Forgery，SSRF) 弱點發生的原因是當目標系統發起的請求被攻擊者控制。由於發起請求者是目標伺服器，因此可以訪問到攻擊者原本無法訪問的檔案，例如：僅限於本地的服務、內網資訊等。要深入研究 SSRF，我們可以先研究 URL。</p><p>以下是一個 URL 的範例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>http://localhost:8787/meow.php?id<span class=o>=</span><span class=m>1</span>
</span></span></code></pre></div><p>我們可以將 URL 的結構拆解並分析：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span>attack surface<span class=o>}</span>://<span class=o>{</span>domain<span class=o>}</span>:<span class=o>{</span>port<span class=o>}</span>/<span class=o>{</span>path<span class=o>}</span>?<span class=o>{</span>parameter<span class=o>}={</span>value<span class=o>}</span>
</span></span></code></pre></div><p><code>{attack surface}</code> 決定可以掌握到的 SSRF 攻擊面。</p><table><thead><tr><th style=text-align:left>協定</th><th style=text-align:left>範例</th></tr></thead><tbody><tr><td style=text-align:left>http</td><td style=text-align:left>發起 HTTP Request</td></tr><tr><td style=text-align:left>file</td><td style=text-align:left>讀取任意檔案</td></tr><tr><td style=text-align:left>gopher</td><td style=text-align:left>構造任意封包</td></tr></tbody></table><p><code>{domain}</code> 決定攻擊的影響的範圍。</p><p>此漏洞發生的位置通常是在使用者能夠輸入網址的位置，在後端處理時通常會將使用者所輸入的網址解析成發送位置，就是攻擊者可以影響到的區域。而 SSRF 能夠讓攻擊者取得僅能從內網訪問的資源或者是本地任意檔案等，我們將在此介紹三個不同協定的攻擊面可造成的影響以及其範圍。</p><p>在 <code>http://</code> 的攻擊面上，能夠嘗試訪問可能存在於本地的 HTTP 服務。例如：localhost 的 8080 埠或 8443 埠都是有可能未公開於外網的埠，若能妥善運用，便能直接取得內網的立足點。在 <code>file://</code> 的攻擊面上，攻擊者能夠讀取本地存在的任意檔案，通常會被利用來讀取本地配置檔 (如 <code>/etc/passwd</code>) 或是網站的原始碼，從而導致資料洩漏的風險。而 <code>gopher://</code> 的攻擊面上，可以利用構造任意封包的特性來構造任意封包，攻擊者可以利用 gopher 的特性來構造 HTTP 協定的 POST 封包，或是構造成其他服務接收的任何封包，因此攻擊者可能利用此技術獲取內網資訊或者達到 RCE。</p><p>要防禦此弱點，我們可以檢查是否已經針對以下項目做好防禦：</p><ul><li>設定 Domain 白名單</li><li>預設協定，不讓攻擊者指定</li></ul></div><div class="flex author"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 alt=Tonya src=/img/author_hu9798571303467919006.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">作者</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Tonya</div><div class="text-sm text-neutral-700 dark:text-neutral-400">就是個喜歡看 Vtuber 的平凡資安人</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=mailto:quontonya@gmail.com target=_blank aria-label=Email rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/TonyaTonya-Nya target=_blank aria-label=Github rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a><a class="px-1 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.linkedin.com/in/tonyawu/ target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="inline-block align-text-bottom"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></span></a></div></div></div></div><div class="flex author author-extra mt-4"><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 src=/img/redmeow_hu10806888911134775893.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">作者</div><a href=https://tonyatonya-nya.github.io/authors/redmeow/ class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Red Meow</a><div class="text-sm text-neutral-700 dark:text-neutral-400">Red Meow</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"></div></div></div></div><div class=mb-10></div><details style=margin-left:0 class="mt-2 mb-5 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5"><summary class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-primary-800 dark:text-neutral-100">IoT 設備檢測實務：攻擊實戰與防禦指南 - 本文屬於一個選集。</summary><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=https://tonyatonya-nya.github.io/materials/iot_security/introduction/>§ 1: 1. IoT 設備安全簡介</a></div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=https://tonyatonya-nya.github.io/materials/iot_security/basic_knowledge/>§ 2: 2. IoT 設備安全基礎知識</a></div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">§ 3: 本文</div><div class="py-1 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><a href=https://tonyatonya-nya.github.io/materials/iot_security/exercise/>§ 4: 4. IoT 設備檢測實戰演練</a></div></details></div><script>var oid="views_materials\\IoT_Security\\Web_Application_Security_Vulnerabilities\\index.md",oid_likes="likes_materials\\IoT_Security\\Web_Application_Security_Vulnerabilities\\index.md"</script><script type=text/javascript src=/js/page.min.0860cf4e04fa2d72cc33ddba263083464d48f67de06114529043cb4623319efed4f484fd7f1730df5abea0e2da6f3538855634081d02f2d6e920b956f063e823.js integrity="sha512-CGDPTgT6LXLMM926JjCDRk1I9n3gYRRSkEPLRiMxnv7U9IT9fxcw31q+oOLabzU4hVY0CB0C8tbpILlW8GPoIw=="></script></section><footer class="pt-8 max-w-prose print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="flex group mr-3" href=/materials/iot_security/basic_knowledge/><span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">2. IoT 設備安全基礎知識</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2024-09-08T00:00:00+00:00>8 September 2024</time>
</span></span></a></span><span><a class="flex text-right group ml-3" href=/materials/iot_security/exercise/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">4. IoT 設備檢測實戰演練</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime=2024-09-08T00:00:00+00:00>8 September 2024</time>
</span></span><span class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div id=top-scroller class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label=捲動到頁頂 title=捲動到頁頂>&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2024
Tonya</p><p class="text-xs text-neutral-500 dark:text-neutral-400">以 <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a> 製作</p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://tonyatonya-nya.github.io/ style=z-index:500><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=搜尋 tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="關閉 (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>